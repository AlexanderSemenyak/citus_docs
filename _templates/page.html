{% extends "!page.html" %}
{#
  You can't override layout.html in RTD
  https://github.com/rtfd/readthedocs.org/issues/152
  Therefore, placing in page.html
#}

{% block extrahead %}
  {{ super() }}

  {# Verify the site for Google Webmaster Tools #}
  <meta name="google-site-verification" content="v8MtCUC2nV2dO-4CSGb5flD1MyPKJvw7wBDOYRwBadw" />

  {# fonts for cookie consent box #}
  <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i" rel="stylesheet" />

  {# Last in <head> to override any canonical link that sphinx adds #}
  {% if pagename in canonical_urls %}
    <link rel="canonical" href="{{ canonical_urls[pagename] }}" />
  {% endif %}
{% endblock %}

{% block sidebartitle %}
  <a href="https://citusdata.com" class="homepage">
    <img src={{ pathto('_images/logo.png', 1) }} class="logo" alt="Logo" />
  </a>

  {{ super() }}
{% endblock %}

{% block body %}

  {{ super() }}

  <div class="new" id="consentBox">
    <div class="consent-text">
      <p>This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use. <a href="https://www.citusdata.com/privacy#cookies" id="cookiesLink">Learn&nbsp;more</a>.</p>
    </div>
    <div class="consent-button">
      <button class="btn" id="closeConsent">CLOSE</button>
    </div>
  </div>

{% endblock %}

{% block footer %}
  {{ super() }}

  {# Heap Analytics #}
  <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
    heap.load("4002524638");
  </script>

  {# Drift chat #}
  <script>
    !function() {
      var t;
      if (t = window.driftt = window.drift = window.driftt || [], !t.init) return t.invoked ? void (window.console && console.error && console.error("Drift snippet included twice.")) : (t.invoked = !0,
      t.methods = [ "identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on" ],
      t.factory = function(e) {
        return function() {
          var n;
          return n = Array.prototype.slice.call(arguments), n.unshift(e), t.push(n), t;
        };
      }, t.methods.forEach(function(e) {
        t[e] = t.factory(e);
      }), t.load = function(t) {
        var e, n, o, i;
        e = 3e5, i = Math.ceil(new Date() / e) * e, o = document.createElement("script"),
        o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + i + "/" + t + ".js",
        n = document.getElementsByTagName("script")[0], n.parentNode.insertBefore(o, n);
      });
    }();
    drift.SNIPPET_VERSION = '0.3.1';
    drift.load('kntc8ig2awfp');

    window.drift.on("startConversation", function() {
      window.ga("send", "event", "Drift", "startConversation");
    });
  </script>

  {# cookie consent dialog #}

  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js'></script>

  <script type="text/javascript">
    $(document).ready(function() {
      var cookieConsent = 'CitusCookieConsentCorner',
          consentValue = 'Consented';

      var clickConsent = function () {
        if ($("#consentBox").is(":visible")) {
          // although the dialog is at the bottom of the screen,
          // "slideUp" actually makes it sink downward...
          $("#consentBox").slideUp("linear");
          $.cookie(cookieConsent, consentValue, {
            expires: 365,
            path: '/'
          });
        }
      };

      // continuing to interact with the page consents to cookies
      $("a:not(#cookiesLink), button, iframe, input, [data-toggle]").on(
        "click", clickConsent
      );

      if (typeof(drift) == 'object' && typeof(drift.on) == 'function') {
        // ditto drift interaction
        drift.on('ready', function (api) {
          drift.on('welcomeMessage:open', clickConsent);
          drift.on('awayMessage:open', clickConsent);
        });
      } else {
        console.log("Drift not found by cookie consent code");
      }

      if ($.cookie(cookieConsent) != consentValue) {
        // "slideDown" makes the dialog pop up!
        $("#consentBox").slideDown("linear");
      }
    });
  </script>
{% endblock %}
